<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel</title>

  <!-- âœ… Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBOTc7OvOA6LUmnHzskMVeOJWhOMk_iY3Y",
      authDomain: "bhojan-valley.firebaseapp.com",
      databaseURL: "https://bhojan-valley-default-rtdb.firebaseio.com",
      projectId: "bhojan-valley",
      storageBucket: "bhojan-valley.firebasestorage.app",
      messagingSenderId: "1036589667387",
      appId: "1:1036589667387:web:9caeb9f9d629d89ca0f81e",
      measurementId: "G-SWYLKYY511"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .order {
      border: 1px solid #ccc;
      padding: 10px;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h2>ğŸ› ï¸ Admin Panel - Manage Orders</h2>

  <div id="ordersContainer">Loading orders...</div>

  <script>
    const ordersContainer = document.getElementById("ordersContainer");

    function loadOrders() {
      db.ref('orders').on('value', (snapshot) => {
        ordersContainer.innerHTML = ""; // clear
        const data = snapshot.val();
        if (!data) {
          ordersContainer.innerText = "âŒ No orders found.";
          return;
        }

        for (let id in data) {
          const order = data[id];
          const div = document.createElement("div");
          div.className = "order";
          div.innerHTML = `
            <strong>ğŸ†” Order ID:</strong> ${id}<br>
            ğŸ½ï¸ <strong>Item:</strong> ${order.item}<br>
            ğŸ“¦ <strong>Quantity:</strong> ${order.qty}<br>
            ğŸ“ <strong>Table:</strong> ${order.table}<br>
            â° <strong>Time:</strong> ${order.time}<br>
            ğŸšš <strong>Status:</strong> <span id="status-${id}">${order.status}</span><br><br>

            <input type="text" id="input-${id}" placeholder="New status" />
            <button onclick="updateStatus('${id}')">Update Status</button>
          `;
          ordersContainer.appendChild(div);
        }
      });
    }

    function updateStatus(orderId) {
      const newStatus = document.getElementById("input-" + orderId).value;
      if (!newStatus) {
        alert("Please enter a status!");
        return;
      }

      db.ref('orders/' + orderId + '/status').set(newStatus)
        .then(() => {
          document.getElementById("status-" + orderId).innerText = newStatus;
          document.getElementById("input-" + orderId).value = "";
          alert("âœ… Status updated!");
        })
        .catch((error) => {
          alert("âŒ Error updating status: " + error);
        });
    }

    loadOrders(); // Start loading on page open
  </script>
</body>
</html>
